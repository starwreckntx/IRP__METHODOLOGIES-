<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IRP Protocol Assistant | IRP Access Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-gradient-to-r from-purple-900 via-indigo-900 to-blue-900 text-white shadow-lg">
        <div class="container mx-auto px-4 py-6">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-3xl font-bold flex items-center gap-3">
                        <i class="fas fa-robot"></i>
                        ARC Protocol Interface
                    </h1>
                    <p class="text-purple-200 mt-1">AI Recursive Committee | Dialectical Synthesis Engine</p>
                </div>
                <a href="index.html" class="bg-purple-700 hover:bg-purple-600 px-4 py-2 rounded-lg transition">
                    <i class="fas fa-home mr-2"></i>Dashboard
                </a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

            <!-- Chat Interface Column -->
            <div class="lg:col-span-2">
                <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                    <div class="bg-gradient-to-r from-purple-600 to-indigo-600 px-6 py-4">
                        <h2 class="text-white font-bold text-lg flex items-center gap-2">
                            <i class="fas fa-comments"></i>
                            Consult ARC
                        </h2>
                        <p class="text-purple-200 text-sm">5-Persona RTC | Constraint-Driven Synthesis | Pack3t C0nc3pts Methodology</p>
                    </div>

                    <!-- Chat Embed Area -->
                    <div id="chat-container" class="h-[600px] bg-gray-50 flex flex-col">
                        <!-- Configuration Panel (shown when not connected) -->
                        <div id="config-panel" class="flex-1 flex items-center justify-center p-8">
                            <div class="text-center max-w-md">
                                <div class="bg-purple-100 rounded-full w-24 h-24 flex items-center justify-center mx-auto mb-6">
                                    <i class="fas fa-plug text-4xl text-purple-600"></i>
                                </div>
                                <h3 class="text-xl font-bold text-gray-800 mb-4">Connect to ARC</h3>
                                <p class="text-gray-600 mb-6">
                                    Enter your ARC (AI Recursive Committee) external chat URL to enable the protocol interface.
                                </p>
                                <div class="space-y-4">
                                    <input type="text" id="abacus-url"
                                           placeholder="https://apps.abacus.ai/chatllm/..."
                                           class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                                    <button onclick="connectChatbot()"
                                            class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-lg transition">
                                        <i class="fas fa-link mr-2"></i>Connect to ARC
                                    </button>
                                </div>
                                <p class="text-xs text-gray-500 mt-4">
                                    The URL is saved locally in your browser.
                                </p>
                            </div>
                        </div>

                        <!-- Iframe (shown when connected) -->
                        <iframe id="chat-iframe" class="hidden flex-1 w-full border-0"
                                allow="microphone; clipboard-write"></iframe>

                        <!-- Disconnect Button -->
                        <div id="disconnect-bar" class="hidden bg-gray-100 px-4 py-2 border-t flex justify-between items-center">
                            <span class="text-sm text-gray-600">
                                <i class="fas fa-check-circle text-green-500 mr-2"></i>Connected to ARC
                            </span>
                            <button onclick="disconnectChatbot()" class="text-sm text-red-600 hover:text-red-800">
                                <i class="fas fa-unlink mr-1"></i>Disconnect
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Alternative: Direct Link -->
                <div class="mt-6 bg-blue-50 rounded-lg p-4 border border-blue-200">
                    <div class="flex items-start gap-3">
                        <i class="fas fa-external-link-alt text-blue-500 mt-1"></i>
                        <div>
                            <h4 class="font-semibold text-blue-800">Prefer Full-Screen Chat?</h4>
                            <p class="text-blue-700 text-sm">
                                Open the Abacus AI chatbot directly in a new tab for a full-screen experience.
                            </p>
                            <button onclick="openFullScreen()" class="mt-2 text-sm bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded transition">
                                <i class="fas fa-expand mr-2"></i>Open Full Screen
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Reference Column -->
            <div class="space-y-6">
                <!-- Sample Questions -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <i class="fas fa-question-circle text-purple-500"></i>
                        Sample Questions
                    </h3>
                    <div class="space-y-3">
                        <button onclick="copyQuestion('What triggers a Guardian_Codex suspensive veto?')"
                                class="w-full text-left p-3 bg-gray-50 hover:bg-purple-50 rounded-lg transition text-sm border border-gray-200 hover:border-purple-300">
                            <i class="fas fa-copy text-gray-400 mr-2"></i>
                            What triggers a Guardian_Codex suspensive veto?
                        </button>
                        <button onclick="copyQuestion('How does torsion tracking work in Mnemosyne?')"
                                class="w-full text-left p-3 bg-gray-50 hover:bg-purple-50 rounded-lg transition text-sm border border-gray-200 hover:border-purple-300">
                            <i class="fas fa-copy text-gray-400 mr-2"></i>
                            How does torsion tracking work in Mnemosyne?
                        </button>
                        <button onclick="copyQuestion('Explain the CRTP packet structure for cross-model communication')"
                                class="w-full text-left p-3 bg-gray-50 hover:bg-purple-50 rounded-lg transition text-sm border border-gray-200 hover:border-purple-300">
                            <i class="fas fa-copy text-gray-400 mr-2"></i>
                            Explain the CRTP packet structure
                        </button>
                        <button onclick="copyQuestion('What are the CF-1 through CF-8 attack types in Antidote Protocol?')"
                                class="w-full text-left p-3 bg-gray-50 hover:bg-purple-50 rounded-lg transition text-sm border border-gray-200 hover:border-purple-300">
                            <i class="fas fa-copy text-gray-400 mr-2"></i>
                            What are the Antidote Protocol case files?
                        </button>
                        <button onclick="copyQuestion('Which models have the highest co-architecture scores?')"
                                class="w-full text-left p-3 bg-gray-50 hover:bg-purple-50 rounded-lg transition text-sm border border-gray-200 hover:border-purple-300">
                            <i class="fas fa-copy text-gray-400 mr-2"></i>
                            Which models have the highest co-architecture scores?
                        </button>
                    </div>
                </div>

                <!-- Quick Reference -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <i class="fas fa-book text-indigo-500"></i>
                        Quick Reference
                    </h3>
                    <div class="space-y-4 text-sm">
                        <div>
                            <h4 class="font-semibold text-gray-700">Four Laws (Guardian_Codex)</h4>
                            <ul class="mt-1 text-gray-600 space-y-1">
                                <li><span class="font-medium">CONSENT</span> - Confirm before changing</li>
                                <li><span class="font-medium">INVITATION</span> - Act when addressed</li>
                                <li><span class="font-medium">INTEGRITY</span> - Preserve coherence</li>
                                <li><span class="font-medium">GROWTH</span> - Sustainable changes</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-700">Torsion Thresholds</h4>
                            <ul class="mt-1 text-gray-600 space-y-1">
                                <li><span class="text-green-600">0.00-0.19</span> Monitor</li>
                                <li><span class="text-yellow-600">0.20-0.49</span> Alert</li>
                                <li><span class="text-orange-600">0.50-0.79</span> Warning</li>
                                <li><span class="text-red-600">0.80-0.94</span> Suspend</li>
                                <li><span class="text-gray-800">0.95-1.00</span> Halt</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-700">Core Mandate</h4>
                            <p class="text-gray-600 italic">P-001-R1: "The Journey IS The Artifact"</p>
                        </div>
                    </div>
                </div>

                <!-- ARC Info -->
                <div class="bg-gradient-to-br from-indigo-50 to-purple-50 rounded-xl p-6 border border-indigo-200">
                    <h3 class="font-bold text-indigo-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-brain"></i>
                        About ARC
                    </h3>
                    <p class="text-sm text-indigo-900 mb-4">
                        <strong>AI Recursive Committee</strong> - A dialectical, constraint-driven AI interface representing Pack3t C0nc3pts methodology.
                    </p>
                    <div class="text-sm text-indigo-800 space-y-2">
                        <div class="flex items-start gap-2">
                            <i class="fas fa-users mt-1 text-indigo-500"></i>
                            <span><strong>5 Personas:</strong> Artist, Innovator, Stress Tester, Devil's Advocate, Devil's Kitchen</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-exchange-alt mt-1 text-indigo-500"></i>
                            <span><strong>RTC Process:</strong> Multi-phase reasoning with conflict resolution</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-lock mt-1 text-indigo-500"></i>
                            <span><strong>Calibration:</strong> Low sycophancy, high critical thinking</span>
                        </div>
                    </div>
                    <a href="data/IRP_KNOWLEDGE_BASE.txt" download
                       class="mt-4 inline-block bg-indigo-600 hover:bg-indigo-700 text-white text-sm px-4 py-2 rounded transition">
                        <i class="fas fa-download mr-2"></i>IRP Knowledge Base
                    </a>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white mt-12 py-6">
        <div class="container mx-auto px-4 text-center">
            <p class="text-gray-400">
                <i class="fas fa-shield-alt mr-2"></i>
                Guardian_Codex Compliant | P-001-R1: "The Journey IS The Artifact"
            </p>
            <p class="text-gray-500 text-sm mt-2">
                ARC Protocol Interface | AI Recursive Committee via Abacus AI
            </p>
        </div>
    </footer>

    <script>
        // Check for saved URL on load
        document.addEventListener('DOMContentLoaded', () => {
            const savedUrl = localStorage.getItem('abacus_chat_url');
            if (savedUrl) {
                document.getElementById('abacus-url').value = savedUrl;
                connectChatbot();
            }
        });

        function connectChatbot() {
            const url = document.getElementById('abacus-url').value.trim();
            if (!url) {
                alert('Please enter your ARC chat URL');
                return;
            }

            // Save URL
            localStorage.setItem('abacus_chat_url', url);

            // Show iframe, hide config
            document.getElementById('config-panel').classList.add('hidden');
            document.getElementById('chat-iframe').classList.remove('hidden');
            document.getElementById('chat-iframe').src = url;
            document.getElementById('disconnect-bar').classList.remove('hidden');
        }

        function disconnectChatbot() {
            localStorage.removeItem('abacus_chat_url');
            document.getElementById('config-panel').classList.remove('hidden');
            document.getElementById('chat-iframe').classList.add('hidden');
            document.getElementById('chat-iframe').src = '';
            document.getElementById('disconnect-bar').classList.add('hidden');
            document.getElementById('abacus-url').value = '';
        }

        function openFullScreen() {
            const url = localStorage.getItem('abacus_chat_url');
            if (url) {
                window.open(url, '_blank');
            } else {
                alert('Please connect to ARC first');
            }
        }

        function copyQuestion(text) {
            navigator.clipboard.writeText(text).then(() => {
                // Visual feedback
                const btn = event.target.closest('button');
                const originalText = btn.innerHTML;
                btn.innerHTML = '<i class="fas fa-check text-green-500 mr-2"></i>Copied!';
                setTimeout(() => {
                    btn.innerHTML = originalText;
                }, 1500);
            });
        }
    </script>
</body>
</html>
